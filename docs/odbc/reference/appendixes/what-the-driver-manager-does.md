---
title: Lo que hace el administrador de conductores Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 07ab0784e6f6ad4487a02a179a5fa3be2617c930
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/14/2020
ms.locfileid: "81306566"
---
# <a name="what-the-driver-manager-does"></a>Lo que hace el Administrador de controladores
En la tabla siguiente se resume cómo el Administrador de controladores ODBC *3.x* asigna las llamadas a controladores ODBC *2.x* y ODBC *3.x.*  
  
|Función o<br /><br /> atributo de instrucción|Comentarios|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Apunta al marcador que se va a utilizar con **SQLFetchScroll**. Los siguientes son detalles de implementación:<br /><br /> - Cuando una aplicación establece esto en un controlador ODBC *2.x,* el Administrador de controladores ODBC *3.x* lo almacena en caché. Desreferencia el puntero y pasa el valor al controlador ODBC *2.x* en el *FetchOffset* argumento de **SQLExtendedFetch** cuando **SQLFetchScroll** es llamado más adelante por la aplicación.<br />- Cuando una aplicación establece esto en un controlador ODBC *3.x,* el Administrador de controladores ODBC *3.x* pasa la llamada al controlador.|  
|SQL_ATTR_ROW_STATUS_PTR|Apunta a la matriz de estado de fila rellenada por **SQLFetch**, **SQLFetchScroll**, **SQLBulkOperations**y **SQLSetPos**. Los siguientes son detalles de implementación:<br /><br /> - Cuando una aplicación establece esto en un controlador ODBC *2.x,* el Administrador de controladores ODBC *3.x* almacena en caché su valor. Pasa este valor al controlador ODBC *2.x* en el *RowStatusArray* argumento de **SQLExtendedFetch** cuando **SQLFetchScroll** o **SQLFetch** se llama.<br />- Cuando una aplicación establece esto en un controlador ODBC *3.x,* el Administrador de controladores ODBC *3.x* pasa la llamada al controlador.<br />- En el estado S6, si una aplicación establece SQL_ATTR_ROW_STATUS_PTR y, a continuación, llama a **SQLBulkOperations** (con una *operación* de SQL_ADD) o **SQLSetPos** sin llamar primero a **SQLFetch** o **SQLFetchScroll**, SQLSTATE HY011 (atributo no se puede establecer ahora) se devuelve.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Apunta al búfer en el que **SQLFetch** y **SQLFetchScroll** devuelven el número de filas recuperadas. Los siguientes son detalles de implementación:<br /><br /> - Cuando una aplicación establece esto en un controlador ODBC *2.x,* el Administrador de controladores ODBC *3.x* almacena en caché su valor. Pasa este valor al controlador ODBC *2.x* en el *RowCountPtr* argumento de **SQLExtendedFetch** cuando **SQLFetch** o **SQLFetchScroll** es llamado por la aplicación.<br />- Cuando una aplicación establece esto en un controlador ODBC *3.x,* el Administrador de controladores ODBC *3.x* pasa la llamada al controlador.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Establece el tamaño del conjunto de filas. Los siguientes son detalles de implementación:<br /><br /> - Cuando una aplicación establece esto en un controlador ODBC *2.x,* el Administrador de controladores ODBC *3.x* lo asigna al atributo de instrucción SQL_ROWSET_SIZE.<br />- Cuando una aplicación establece esto en un controlador ODBC *3.x,* el Administrador de controladores ODBC *3.x* pasa la llamada al controlador.<br />- Cuando una aplicación que trabaja con un controlador ODBC *3.x* llama a **SQLSetScrollOptions**, SQL_ROWSET_SIZE se establece en el valor del argumento *RowsetSize* si el controlador subyacente no admite **SQLSetScrollOptions**.|  
|SQL_ROWSET_SIZE|Establece el tamaño del conjunto de filas utilizado por **SQLExtendedFetch** cuando **SQLExtendedFetch** es llamado por una aplicación ODBC *2.x.* Los siguientes son detalles de implementación:<br /><br /> - Cuando una aplicación establece esto, el Administrador de controladores ODBC *3.x* pasa la llamada al controlador, independientemente de la versión del controlador.<br />- Cuando una aplicación que trabaja con un controlador ODBC *2.x* llama a **SQLSetScrollOptions**, SQL_ROWSET_SIZE se establece en el valor en el **RowsetSize** argumento.|  
|**SQLBulkOperations**|Realiza una operación de inserción, o actualiza, elimina o recupera mediante operaciones de marcador. Los siguientes son detalles de implementación:<br /><br /> - Cuando una aplicación llama a **SQLBulkOperations** con una *operación* de SQL_ADD en un controlador ODBC *2.x,* el Administrador de controladores ODBC *3.x* lo asigna a **SQLSetPos** con una *operación* de SQL_ADD.<br />- Cuando se trabaja con un controlador ODBC *2.x* que no admite **SQLSetPos** con una *operación* de SQL_ADD, el Administrador de controladores ODBC *3.x* no asigna **SQLSetPos** con una *operación* de SQL_ADD a **SQLBulkOperations** con una *operación* de SQL_ADD. Esto se debe a que no se puede llamar a **SQLBulkOperations** en el estado S7, que en ODBC *2.x* era el único estado en el que se podía llamar a **SQLSetPos.**<br />- Si la aplicación llama a **SQLBulkOperations** con una *operación* de SQL_ADD en un controlador ODBC *2.x* antes de llamar a **SQLFetchScroll**, el Administrador de controladores ODBC *3.x* devuelve un error.|  
|**SQLExtendedFetch**|Devuelve el conjunto de filas especificado. Excepto por la restricción que solo se indica, el Administrador de controladores ODBC *3.x* pasa llamadas a **SQLExtendedFetch** al controlador, independientemente de la versión del controlador.|  
|**SQLFetch**|Devuelve el siguiente conjunto de filas. Los siguientes son detalles de implementación:<br /><br /> - Cuando una aplicación llama a **SQLFetch** en un controlador ODBC *2.x,* el Administrador de controladores ODBC *3.x* lo asigna a **SQLExtendedFetch**. El *FetchOrientation* argumento de **SQLExtendedFetch** se establece en SQL_FETCH_NEXT. El Administrador de controladores utiliza el valor almacenado en caché del atributo de instrucción SQL_ATTR_ROW_STATUS_PTR para el *RowStatusArray* argumento y el valor almacenado en caché del SQL_ATTR_ROWS_FETCHED_PTR atributo de instrucción para el *RowCountPtr* argumento.<br />- Una aplicación ODBC *3.x* puede mezclar llamadas a **SQLFetch** y **SQLFetchScroll** en un controlador ODBC *2.x* porque el Administrador de controladores ODBC *3.x* asigna **SQLFetch** a **SQLExtendedFetch** cuando una aplicación lo llama en un controlador ODBC *2.x.*<br />- Si un controlador ODBC *2.x* no admite **SQLExtendedFetch**, el Administrador de controladores ODBC *3.x* no asigna **SQLFetch** o **SQLFetchScroll** a **SQLExtendedFetch** cuando una aplicación lo llama en ese controlador. Si la aplicación intenta establecer SQL_ATTR_ROW_ARRAY_SIZE en un valor mayor que 1, sqlSTATE HYC00 (característica opcional no implementada) se devuelve.<br />- Excepto por las restricciones que acaba de señalar, el Administrador de controladores ODBC *3.x* pasa llamadas a **SQLFetch** al controlador, independientemente de la versión del controlador.|  
|**SQLFetchScroll**|Devuelve el conjunto de filas especificado. Los siguientes son detalles de implementación:<br /><br /> - Cuando una aplicación llama a **SQLFetchScroll** en un controlador ODBC *2.x,* el Administrador de controladores ODBC *3.x* lo asigna a **SQLExtendedFetch**. Utiliza el valor almacenado en caché del atributo de instrucción SQL_ATTR_ROW_STATUS_PTR para el *RowStatusArray* argumento y el valor almacenado en caché del SQL_ATTR_ROWS_FETCHED_PTR atributo de instrucción para el *RowCountPtr* argumento. Si el *FetchOrientation* argumento en **SQLFetchScroll** es SQL_FETCH_BOOKMARK, utiliza el valor almacenado en caché de la SQL_ATTR_FETCH_BOOKMARK_PTR atributo de instrucción para el *FetchOffset* argumento y devuelve un error si el *FetchOffset* argumento de **SQLFetchScroll** no es 0.<br />- Cuando una aplicación llama a esto en un controlador ODBC *3.x,* el Administrador de controladores ODBC *3.x* pasa la llamada al controlador.|  
|**SQLSetPos**|Realiza varias operaciones posicionadas. El Administrador de controladores ODBC *3.x* pasa las llamadas a **SQLSetPos** al controlador, independientemente de la versión del controlador.|  
|**SQLSetScrollOptions**|Cuando el Administrador de controladores asigna **SQLSetScrollOptions** para una aplicación que trabaja con un controlador ODBC *3.x* que no admite **SQLSetScrollOptions**, el Administrador de controladores establece la opción de instrucción SQL_ROWSET_SIZE, no el atributo de instrucción *SQL_ATTR_ROW_ARRAY_SIZE,* en el argumento RowsetSize de **SQLSetScrollOption**. Como resultado, **SQLSetScrollOptions** no se puede utilizar una aplicación al capturar varias filas mediante una llamada a **SQLFetch** o **SQLFetchScroll**. Solo se puede utilizar cuando se capturan varias filas mediante una llamada a **SQLExtendedFetch**.|
